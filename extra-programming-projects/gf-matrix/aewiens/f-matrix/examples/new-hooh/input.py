#!/usr/bin/env python

import sys, numpy as np
sys.path.append('../..')
from molecule import Molecule
from frequencies import Frequencies

hooh = Molecule(
"""
H
O 1 r1 
O 2 r2 1 a1
H 3 r1 2 a1 1 t1

r1 = 0.9625
r2 = 1.4535
a1 = 99.64
t1 = 113.7
"""
)


##  force constant matrix from CFOUR
h = open("FCALLEN","r").read()

G = np.array([[  1.05475559e+00,  -1.04693939e-02,  -4.24059519e-02,   0.00000000e+00,
   -1.70449781e-02,  -6.59541269e-03],
 [ -1.04693939e-02,   1.25039742e-01,  -6.40384947e-02,  -1.04693939e-02,
   -6.40384947e-02,  -1.30145626e-18],
 [ -4.24059519e-02,  -6.40384947e-02,   1.21269832e+00,  -1.70449781e-02,
    2.98055930e-02,   5.18754099e-02],
 [  0.00000000e+00,  -1.04693939e-02,  -1.70449781e-02,   1.05475559e+00,
   -4.24059519e-02,  -6.59541269e-03],
 [ -1.70449781e-02,  -6.40384947e-02,   2.98055930e-02,  -4.24059519e-02,
    1.21269832e+00,   5.18754099e-02],
 [ -6.59541269e-03,  -1.30145626e-18,   5.18754099e-02,  -6.59541269e-03,
    5.18754099e-02,   2.36324802e+00]])


print(G)

ref  = [611.2967, 958.2339, 1476.2838, 1595.8559, 3928.9343, 3933.2232 ][::-1]

print("----------------------------------------")
print("   HOOH Harmonics:         Reference:")
freq = Frequencies(hooh,h,G)
for i,j in enumerate( freq.getFrequencies() ):
	print( "{:d} {:20.12f} {:20.12f}".format(i+1,j,ref[i]) )
print("----------------------------------------")
